<script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
<script type="text/javascript">
    var app = new Vue({
        el: '#app',
        data: {
            isLoading: true,
            eResult: '読み込み中..',
            isTennisAdded: false
        },
        methods: {
            addTennisFunction: function () {
                this.eResult = "追加中..";
                google.script.run
                    .withSuccessHandler((result) => {
                        this.eResult = result;
                        this.isTennisAdded = true;
                    })
                    .addTennis();
            },
            removeTennisFunction: function () {
                this.eResult = "削除中..";
                google.script.run
                    .withSuccessHandler((result) => {
                        if (result) {
                            this.eResult = "削除成功";
                        } else {
                            this.eResult = "削除失敗";
                        }
                        this.isTennisAdded = false;
                    })
                    .removeTodayTennis();

            },
            updateTennisAdded: function (handler) {
                google.script.run
                    .withSuccessHandler((result) => {
                        if (handler) {
                            handler();
                        }
                        this.eResult = "";
                        if (result) {
                            this.eResult = "テニスの予定は追加済みです";
                            this.isTennisAdded = result
                        }
                    })
                    .isTennisAdded();

            }
        },
        mounted() {
            window.onload = () => {
                app.updateTennisAdded(() => this.isLoading = false)
            }
        }
    });
</script>